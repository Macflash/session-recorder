(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{15:function(e,t,n){},16:function(e,t,n){},17:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(7),i=n.n(o),c=(n(15),n(1)),s=n(2),l=n(4),u=n(3),d=n(5),m=(n(16),n(8)),p=function(e,t,n){var a=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return a?new Promise(function(t,n){a.call(navigator,e,t,n)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))},f=function(){void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=p)},v=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).clipCanvas=null,n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(){if(this.clipCanvas){var e=this.clipCanvas.getContext("2d"),t=this.clipCanvas.width,n=this.clipCanvas.height;e.fillStyle="rgb(25, 25, 25)",e.fillRect(0,0,t,n),e.lineWidth=2,e.strokeStyle="rgb(125, 125, 125)";var a=1*t/this.props.waveform.length,r=0,o=0,i=n/2;e.beginPath(),e.moveTo(o,i);for(var c=0;c<this.props.waveform.length;c++){var s=this.props.waveform[c]/128*n/2;this.props.waveform[c]>140||this.props.waveform[c],e.lineTo(r,s),o=r,i=s,r+=a}e.stroke()}}},{key:"render",value:function(){var e=this;return r.a.createElement("canvas",{height:"100",width:"1000",ref:function(t){!e.clipCanvas&&t&&(e.clipCanvas=t,e.setState({clipCanvas:t}))},style:{flex:"auto"}})}}]),t}(a.Component),h=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).clipCanvas=null,n.download=function(){var e=n.props.clipInfo,t=document.createElement("a");t.href=e.audioUrl,t.download=(e.sessionName?e.sessionName+"_":"")+e.trackName+".webm",document.body.appendChild(t),n.download&&t.click(),document.body.removeChild(t)},n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.clipInfo,n=e.showAudio,a=e.onDelete;return r.a.createElement("div",{style:{display:"flex",flexDirection:"row",height:"100px",margin:"5px"}},r.a.createElement("div",{style:{flex:"none",display:"flex",alignItems:"center",margin:"5px"}},t.trackNumber),r.a.createElement("div",{style:{flex:"auto",display:"flex",flexDirection:"column",maxWidth:"80%",minWidth:"50%"}},r.a.createElement(v,{waveform:t.waveform}),n&&r.a.createElement("audio",{controls:!0,style:{width:"100%",height:"40px",marginTop:"10px"},src:t.audioUrl})),r.a.createElement("div",{style:{margin:"5px",justifyContent:"space-around",flex:"none",display:"flex",flexDirection:"column"}},r.a.createElement("div",{style:{flex:"none"}},t.trackName),r.a.createElement("div",{style:{flex:"none"}},r.a.createElement("button",{onClick:a},"Delete")),r.a.createElement("div",{style:{flex:"none"}},r.a.createElement("button",{onClick:this.download},"Download"))))}}]),t}(a.Component),g=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.title,n=e.screen;return r.a.createElement("div",{style:{justifyContent:"space-between",alignItems:"center",marginBottom:"auto",display:"flex",fontSize:"125%"}},("recording"==status||"armed"==status)&&"Recording",t,"record"==n&&r.a.createElement("button",{style:{marginLeft:"auto"}},"Listen"),"listen"==n&&r.a.createElement("button",{style:{marginLeft:"auto"}},"Record"))}}]),t}(a.Component),b=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{style:{position:"absolute",top:"5%",bottom:"5%",left:"5%",right:"5%",display:"flex",flexDirection:"column",justifyContent:"flex-end"}},this.props.children)}}]),t}(a.Component),w=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.size||"75px";return r.a.createElement("button",{onClick:this.props.onClick,title:this.props.title,style:{height:e,width:e,borderRadius:e,backgroundColor:"rgb(225,0,0)",border:"none",cursor:"pointer"}})}}]),t}(a.PureComponent),y=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.size||"75px";return r.a.createElement("button",{onClick:this.props.onClick,title:this.props.title,style:{height:e,width:e,backgroundColor:"rgb(125,125,125)",border:"none",cursor:"pointer"}})}}]),t}(a.PureComponent),j=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{style:{flex:"none",display:"flex",flexDirection:this.props.direction||"row",textAlign:"center",justifyContent:"space-around",alignItems:"center",padding:"5px"}},this.props.children)}}]),t}(a.Component),C=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{style:{padding:"10% 15px",display:"flex"}},this.props.children)}}]),t}(a.Component),k=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).mediaRecorder=void 0,n.maxSilence=100,n.minSaveLength=1e3,n.lastClip=void 0,n.saveMode="autodecide",n.lastNoiseCounter=0,n.chunks=[],n.waveform=[],n.trackCount=1,n.stream=void 0,n.saveClip=function(e){e.trackName="Track "+n.trackCount,e.trackNumber=n.trackCount,n.trackCount++,n.setState({clips:[].concat(Object(m.a)(n.state.clips),[e]),lastClip:void 0}),n.lastClip=void 0,n.waveform=[]},n.record=function(){if(!n.mediaRecorder)throw"No recorder!";n.mediaRecorder.start(),n.setState({status:"recording"})},n.pause=function(){if(!n.mediaRecorder)throw"No recorder!";n.mediaRecorder.pause(),n.setState({status:"paused"})},n.resume=function(){if(!n.mediaRecorder)throw"No recorder!";n.mediaRecorder.resume(),n.setState({status:"recording"})},n.split=function(){if(!n.mediaRecorder)throw"No recorder!";n.mediaRecorder.stop(),n.setState({status:"armed"})},n.stop=function(){if(!n.mediaRecorder)throw"No recorder!";"recording"!=n.mediaRecorder.state&&"paused"!=n.mediaRecorder.state||n.mediaRecorder.stop(),n.setState({status:"ready"})},f(),navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?(console.log("getUserMedia supported."),navigator.mediaDevices.getUserMedia({audio:!0}).then(function(e){n.stream=e;var t=new AudioContext,a=t.createMediaStreamSource(e),r=t.createAnalyser();a.connect(r);var o=r.fftSize;console.log(o);var i=new Uint8Array(o),c=document.querySelector(".visualizer"),s=c.getContext("2d");!function e(){var t=c.width,a=c.height;requestAnimationFrame(e),r.getByteTimeDomainData(i);var o=1e14,l=-1e14;i.forEach(function(e){o=Math.min(e,o),l=Math.max(e,l)}),n.waveform=n.waveform.concat([o,l]),"recording"!=n.state.status&&n.waveform.length>n.maxSilence&&n.waveform.length<n.minSaveLength&&(n.waveform=n.waveform.slice(n.waveform.length-n.maxSilence)),l>140||o<100?(n.lastNoiseCounter=0,"armed"==n.state.status&&n.record()):(n.lastNoiseCounter++,n.lastNoiseCounter>n.maxSilence&&"recording"==n.state.status&&n.split()),s.fillStyle="rgb(25, 25, 25)",s.fillRect(0,0,t,a),s.lineWidth=2,"recording"==n.state.status?s.strokeStyle="rgb(225, 0, 0)":s.strokeStyle="rgb(75, 75, 75)";var u=1*t/n.waveform.length,d=0,m=0,p=a/2;s.beginPath(),s.moveTo(m,p);for(var f=0;f<n.waveform.length;f++){var v=n.waveform[f]/128*a/2;n.waveform[f]>140||n.waveform[f],s.lineTo(d,v),m=d,p=v,d+=u}s.lineTo(c.width,c.height/2),s.stroke()}(),n.mediaRecorder=new MediaRecorder(e,{mimeType:"audio/webm",audioBitsPerSecond:32e4}),n.mediaRecorder.onstart=function(e){n.chunks=[],n.waveform=[]},n.mediaRecorder.ondataavailable=function(e){n.chunks.push(e.data)},n.mediaRecorder.onstop=function(e){var t=new Blob(n.chunks,{type:"audio/webm"});n.chunks=[];var a={audioUrl:window.URL.createObjectURL(t),waveform:n.waveform};if(n.lastClip=a,n.setState({lastClip:a}),"autodecide"==n.saveMode&&(console.log("waveform length: "+a.waveform.length),a.waveform.length<n.minSaveLength))console.log("skip saving the track since it is so short");else{if("skipNext"==n.saveMode)return n.saveMode="autodecide",void console.log("skip saving because we are in skipNext save mode");"saveNext"==n.saveMode&&(n.saveMode="autodecide",console.log("force saving because we are in saveNext save mode")),n.saveClip(a)}},n.setState({status:"armed"})}).catch(function(e){console.error("The following getUserMedia error occured: "+e)})):console.error("getUserMedia not supported on your browser!"),n.state={status:"initializing",clips:[]},n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){this.stream&&this.stream.stop()}},{key:"render",value:function(){var e=this,t=this.state,n=t.status,a=t.clips,o=t.lastClip;return r.a.createElement(b,null,r.a.createElement(g,{title:"Recording "+(this.props.sessionName||""),screen:"record"}),r.a.createElement("div",{style:{overflow:"auto",flex:"auto",margin:"25px 10px"}},a.map(function(t,n){return r.a.createElement(h,{key:n,clipInfo:t,onDelete:function(){a.splice(n,1);e.setState({clips:a.slice()})}})})),r.a.createElement(C,null,r.a.createElement("canvas",{className:"visualizer",height:"100",width:"1000",style:{width:"100%"}})),r.a.createElement(j,null,"recording"!=n&&o&&r.a.createElement("button",{onClick:function(){e.saveClip(o)}},"Save"),"recording"==n&&r.a.createElement("button",{onClick:function(){e.saveMode="saveNext",e.split()}},"Save"),"ready"==n&&r.a.createElement(w,{onClick:function(){e.setState({status:"armed"})},title:"Arm for recording"}),("recording"==n||"armed"==n)&&r.a.createElement(y,{onClick:this.stop,title:"Stop"}),"recording"!=n&&o&&r.a.createElement("button",{onClick:function(){e.setState({lastClip:void 0})}},"Skip"),"recording"==n&&r.a.createElement("button",{onClick:function(){e.saveMode="skipNext",e.split()}},"Skip")))}}]),t}(a.Component),O=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(b,null,r.a.createElement(g,{title:"Session Recorder",screen:"start"}),r.a.createElement(C,null,r.a.createElement("input",{onChange:function(t){e.props.onSessionNameChange(t.target.value)},type:"textfield",style:{height:"50px",flex:"auto",fontSize:"200%",padding:"5px",textAlign:"center"}})),r.a.createElement(j,null,r.a.createElement(w,{onClick:this.props.onStart,title:"Start a new session"})))}}]),t}(a.Component),x=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},r.a.createElement("div",null,"Listening blah"),r.a.createElement("div",null,r.a.createElement("button",null,"Listen up!")))}}]),t}(a.Component),E=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={currentScreen:"start"},n}return Object(d.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;switch(this.state.currentScreen){case"record":return r.a.createElement(k,{sessionName:this.state.sessionName});case"listen":return r.a.createElement(x,null);case"start":default:return r.a.createElement(O,{onSessionNameChange:function(t){e.setState({sessionName:t})},onStart:function(){e.setState({currentScreen:"record"})}})}}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(E,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},9:function(e,t,n){e.exports=n(17)}},[[9,1,2]]]);
//# sourceMappingURL=main.32414af7.chunk.js.map