(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{15:function(e,t,a){},16:function(e,t,a){},17:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(7),i=a.n(o),c=(a(15),a(1)),s=a(2),l=a(4),d=a(3),m=a(5),u=(a(16),a(8)),v=function(e,t,a){var n=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return n?new Promise(function(t,a){n.call(navigator,e,t,a)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))},f=function(){void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=v)},p=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).clipCanvas=null,a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(){if(this.clipCanvas){var e=this.clipCanvas.getContext("2d"),t=this.clipCanvas.width,a=this.clipCanvas.height;e.fillStyle="rgb(25, 25, 25)",e.fillRect(0,0,t,a),e.lineWidth=2,e.strokeStyle="rgb(225, 225, 225)";var n=1*t/this.props.waveform.length,r=0,o=0,i=a/2;e.beginPath(),e.moveTo(o,i);for(var c=0;c<this.props.waveform.length;c++){var s=this.props.waveform[c]/128*a/2;this.props.waveform[c]>140||this.props.waveform[c],e.lineTo(r,s),o=r,i=s,r+=n}e.stroke()}}},{key:"render",value:function(){var e=this;return r.a.createElement("canvas",{height:"50",width:"1000",ref:function(t){!e.clipCanvas&&t&&(e.clipCanvas=t,e.setState({clipCanvas:t}))},style:{flex:"auto"}})}}]),t}(n.Component),h=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).clipCanvas=null,a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.clipInfo;return r.a.createElement("div",{style:{display:"flex",flexDirection:"row",height:"100px",margin:"5px"}},r.a.createElement("div",{style:{flex:"none",display:"flex",alignItems:"center",margin:"5px"}},e.trackNumber),r.a.createElement("div",{style:{flex:"auto",display:"flex",flexDirection:"column",maxWidth:"80%",minWidth:"50%"}},r.a.createElement(p,{waveform:e.waveform}),r.a.createElement("audio",{controls:!0,style:{width:"100%",height:"40px",marginTop:"10px"},src:e.audioUrl})),r.a.createElement("div",{style:{margin:"5px",justifyContent:"space-around",flex:"none",display:"flex",flexDirection:"column"}},r.a.createElement("div",{style:{flex:"none"}},e.name),r.a.createElement("div",{style:{flex:"none"}},r.a.createElement("button",{onClick:this.props.onDelete},"Delete"))))}}]),t}(n.Component),g=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(l.a)(this,Object(d.a)(t).call(this,e))).mediaRecorder=void 0,a.maxSilence=100,a.minSaveLength=1e3,a.lastClip=void 0,a.name=void 0,a.download=!1,a.saveMode="autodecide",a.lastNoiseCounter=0,a.chunks=[],a.waveform=[],a.trackCount=1,a.saveClip=function(e){a.trackCount++,a.setState({clips:[].concat(Object(u.a)(a.state.clips),[e]),lastClip:void 0}),a.lastClip=void 0,a.waveform=[];var t=document.createElement("a");t.href=e.audioUrl,t.download=(a.name?a.name+"_":"")+name+".webm",document.body.appendChild(t),a.download&&t.click()},a.record=function(){if(!a.mediaRecorder)throw"No recorder!";a.mediaRecorder.start(),a.setState({status:"recording"})},a.pause=function(){if(!a.mediaRecorder)throw"No recorder!";a.mediaRecorder.pause(),a.setState({status:"paused"})},a.resume=function(){if(!a.mediaRecorder)throw"No recorder!";a.mediaRecorder.resume(),a.setState({status:"recording"})},a.split=function(){if(!a.mediaRecorder)throw"No recorder!";a.mediaRecorder.stop(),a.setState({status:"armed"})},a.stop=function(){if(!a.mediaRecorder)throw"No recorder!";"recording"!=a.mediaRecorder.state&&"paused"!=a.mediaRecorder.state||a.mediaRecorder.stop(),a.setState({status:"ready"})},f(),navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?(console.log("getUserMedia supported."),navigator.mediaDevices.getUserMedia({audio:!0}).then(function(e){var t=new AudioContext,n=t.createMediaStreamSource(e),r=t.createAnalyser();n.connect(r);var o=r.fftSize;console.log(o);var i=new Uint8Array(o),c=document.querySelector(".visualizer"),s=c.getContext("2d");!function e(){var t=c.width,n=c.height;requestAnimationFrame(e),r.getByteTimeDomainData(i);var o=1e14,l=-1e14;i.forEach(function(e){o=Math.min(e,o),l=Math.max(e,l)}),a.waveform=a.waveform.concat([o,l]),"recording"!=a.state.status&&a.waveform.length>a.maxSilence&&a.waveform.length<a.minSaveLength&&(a.waveform=a.waveform.slice(a.waveform.length-a.maxSilence)),l>140||o<100?(a.lastNoiseCounter=0,"armed"==a.state.status&&a.record()):(a.lastNoiseCounter++,a.lastNoiseCounter>a.maxSilence&&"recording"==a.state.status&&a.split()),s.fillStyle="rgb(25, 25, 25)",s.fillRect(0,0,t,n),s.lineWidth=2,s.strokeStyle="rgb(255, 255, 255)";var d=1*t/a.waveform.length,m=0,u=0,v=n/2;s.beginPath(),s.moveTo(u,v);for(var f=0;f<a.waveform.length;f++){var p=a.waveform[f]/128*n/2;a.waveform[f]>140||a.waveform[f],s.lineTo(m,p),u=m,v=p,m+=d}s.lineTo(c.width,c.height/2),s.stroke()}(),a.mediaRecorder=new MediaRecorder(e,{mimeType:"audio/webm",audioBitsPerSecond:32e4}),a.mediaRecorder.onstart=function(e){a.chunks=[],a.waveform=[]},a.mediaRecorder.ondataavailable=function(e){a.chunks.push(e.data)},a.mediaRecorder.onstop=function(e){var t=new Blob(a.chunks,{type:"audio/webm"});a.chunks=[];var n={audioUrl:window.URL.createObjectURL(t),name:"Track "+a.trackCount,waveform:a.waveform,trackNumber:a.trackCount};if(a.lastClip=n,a.setState({lastClip:n}),"autodecide"==a.saveMode&&(console.log("waveform length: "+n.waveform.length),n.waveform.length<a.minSaveLength))console.log("skip saving the track since it is so short");else{if("skipNext"==a.saveMode)return a.saveMode="autodecide",void console.log("skip saving because we are in skipNext save mode");"saveNext"==a.saveMode&&(a.saveMode="autodecide",console.log("force saving because we are in saveNext save mode")),a.saveClip(n)}},a.setState({status:"ready"})}).catch(function(e){console.error("The following getUserMedia error occured: "+e)})):console.error("getUserMedia not supported on your browser!"),a.state={status:"initializing",clips:[]},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.status,n=t.clips,o=t.lastClip;return r.a.createElement("div",{style:{display:"flex",flexDirection:"column",height:"100%",justifyContent:"flex-end"}},r.a.createElement("div",{style:{justifyContent:"center",alignItems:"center",margin:"10px",display:"flex",fontSize:"125%"}}," ",("recording"==a||"armed"==a)&&"Recording"," ",this.name),r.a.createElement("div",{style:{overflow:"auto",flex:"auto",margin:"25px 10px"}},n.map(function(t,a){return r.a.createElement(h,{key:a,clipInfo:t,onDelete:function(){n.splice(a,1);e.setState({clips:n.slice()})}})})),r.a.createElement("div",{style:{flex:"none",textAlign:"center",justifyContent:"center"}},r.a.createElement("canvas",{className:"visualizer",height:"100",width:"1000",style:{width:"100%"}})),r.a.createElement("div",{style:{flex:"none",textAlign:"center",justifyContent:"center"}},a),r.a.createElement("div",{style:{flex:"none",display:"flex",flexDirection:"row",textAlign:"center",justifyContent:"center",alignItems:"center"}},"ready"==a&&r.a.createElement("button",{onClick:function(){e.setState({status:"armed"})},title:"Arm for recording",style:{height:"50px",width:"50px",borderRadius:"100px",backgroundColor:"rgb(225,0,0)",border:"none",margin:"10px",cursor:"pointer"}}),"recording"==a&&r.a.createElement("button",{onClick:function(){e.saveMode="saveNext",e.split()}},"Save"),("recording"==a||"armed"==a)&&r.a.createElement("button",{onClick:this.stop,title:"Stop",style:{height:"50px",width:"50px",border:"none",backgroundColor:"grey",cursor:"pointer",margin:"10px"}}),"recording"==a&&r.a.createElement("button",{onClick:function(){e.saveMode="skipNext",e.split()}},"Skip")),r.a.createElement("div",{style:{marginBottom:"50px",flex:"none",display:"flex",flexDirection:"row",textAlign:"center",justifyContent:"center"}},"recording"==a||"armed"==a?r.a.createElement("div",null,this.name):r.a.createElement("input",{type:"textarea",defaultValue:this.name,onChange:function(t){e.name=t.target.value},placeholder:"Name your session"}),r.a.createElement("input",{type:"checkbox",onChange:function(t){e.download=t.target.checked}})," Save","recording"!=a&&o&&r.a.createElement("button",{onClick:function(){e.saveClip(o)}},"Save Last")))}}]),t}(n.Component),w=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement(g,null)}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(w,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},9:function(e,t,a){e.exports=a(17)}},[[9,1,2]]]);
//# sourceMappingURL=main.23f59305.chunk.js.map